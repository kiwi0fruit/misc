# Kiwi0Fruit's translit

## Yet another Russian to Latin translit

Придумал в качестве развлечения ещё один транслит. Развлечением было удовлетворить ограничениям:

* Транслит - полностью обратимый (является кодировкой без потерь и позволяет точно восстановить произвольный русский текст из латиницы),
* Транслит содержит только буквы и нижнее подчёркивание (в частности, не использует апостроф): отображение из русских букв `[А-Яа-я_]` в английские `[A-Za-z_]`,
* Не содержит далёких фонетических замен типа щ → w. Желательно, чтобы "звучало" похоже на английский, латинский или немецкий.


## Киррилица => латиница

...

## Латиница => киррилица

### Шаг 1

|     | Cyr.           | Lat.  |
| --- | --------------:|:----- |
| к,x | `кх`           | `khh` |
| э,x | `эх`           | `ehh` |
| щ   | `щ`            | `shh` |
| ы   | `ы(?=[эоауи])` | `yhh` |

### Шаг 2

| Cyr.  | Lat.           |
| -----:|:-------------- |
| `ж`   | `zh`           |
| `ч`   | `ch`           |
| `ш`   | `sh`           |
| `э`   | `eh`           |

### Шаг 3 

|    | Cyr.       | Lat.        |
| -- | ----------:|:----------- |
| e  | `(?<\c)ье` | `(?<\c)jye` |
| e  | `(?<\c)ъе` | `(?<\c)je`  |
| e  | `ые`       | `yje`       |
| ё  | `(?<\c)ьё` | `(?<\c)jyo` |
| ё  | `(?<\c)ъё` | `(?<\c)jo`  |
| ё  | `ыё`       | `yjo`       |
| ю  | `(?<\c)ью` | `(?<\c)jyu` |
| ю  | `(?<\c)ъю` | `(?<\c)ju`  |
| ю  | `ыю`       | `yju`       |
| я  | `(?<\c)ья` | `(?<\c)jya` |
| я  | `(?<\c)ъя` | `(?<\c)ja`  |
| я  | `ыя`       | `yja`       |
| и  | `(?<\c)ьи` | `(?<\c)jyi` |
|    |            |             |
| ъ  | `(?<\c)ъ[еёюя]`       | `(?<\c)j[eoua]`   |
| ы  | `ы[еёюя]`             | `yj[eoua]`        |
| ь  | `(?<\c)ь[еёюяи]`      | `(?<\c)jy[eouai]` |
| ь  | `(?<\c)ь`             | `(?<\c)j`         |
| й  | `(?<\c)й`             | `jh`              |
| й  | `(?<[ъь_])й(?=[ъь_])` | `jh`              |
| й  | `(?<ы)й(?=[еоау])`    | `jh`              |
| х  | `(?<[зсхцчжшщьей])х`  | `kh`              |
| х  | `(?<[ъь_])х(?=[ъь_])` | `kh`              |

`\c` - согласная (consonant), но не йот. Специальный символ регулярных выражений для `[qwrtpsdfghklzxcvbnmцкнгшщзхфвпрлджчсмтб]` (но без й, j).

### Шаг 4

| Cyr | Lat     | Cyr | Lat | Cyr | Lat     |
| ---:|:------- | ---:|:--- | ---:|:------- |
| `а` | `a`     | `н` | `n` | `е` | `e`     |
| `б` | `b`     | `о` | `o` | `ё` | `yo`    |
| `в` | `v`     | `п` | `p` | `и` | `i`     |
| `г` | `g`     | `р` | `r` | `ю` | `yu`    |
| `д` | `d`     | `с` | `s` | `я` | `ya`    |
| `з` | `z`     | `т` | `t` | `й` | `j`     |
| `к` | `k`     | `у` | `u` | `ы` | `y`     |
| `л` | `l`     | `ф` | `f` | `ъ` | `_h_`   |
| `м` | `m`     | `ц` | `c` | `ь` | `_j_`   |
| ERR | `[qwx]` | `x` | `h` | `_` | `_`     |

Многие буквы совпадают с [ГОСТ 16876-71 табл. 2](https://ru.wikipedia.org/wiki/%D0%A2%D1%80%D0%B0%D0%BD%D1%81%D0%BB%D0%B8%D1%82%D0%B5%D1%80%D0%B0%D1%86%D0%B8%D1%8F_%D1%80%D1%83%D1%81%D1%81%D0%BA%D0%BE%D0%B3%D0%BE_%D0%B0%D0%BB%D1%84%D0%B0%D0%B2%D0%B8%D1%82%D0%B0_%D0%BB%D0%B0%D1%82%D0%B8%D0%BD%D0%B8%D1%86%D0%B5%D0%B9#%D0%A1%D1%80%D0%B0%D0%B2%D0%BD%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F_%D1%82%D0%B0%D0%B1%D0%BB%D0%B8%D1%86%D0%B0_%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC_%D1%82%D1%80%D0%B0%D0%BD%D1%81%D0%BB%D0%B8%D1%82%D0%B5%D1%80%D0%B0%D1%86%D0%B8%D0%B8) или [ГОСТ 7.79-2000 сист. Б](https://ru.wikipedia.org/wiki/%D0%A2%D1%80%D0%B0%D0%BD%D1%81%D0%BB%D0%B8%D1%82%D0%B5%D1%80%D0%B0%D1%86%D0%B8%D1%8F_%D1%80%D1%83%D1%81%D1%81%D0%BA%D0%BE%D0%B3%D0%BE_%D0%B0%D0%BB%D1%84%D0%B0%D0%B2%D0%B8%D1%82%D0%B0_%D0%BB%D0%B0%D1%82%D0%B8%D0%BD%D0%B8%D1%86%D0%B5%D0%B9#%D0%A1%D1%80%D0%B0%D0%B2%D0%BD%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D0%B0%D1%8F_%D1%82%D0%B0%D0%B1%D0%BB%D0%B8%D1%86%D0%B0_%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC_%D1%82%D1%80%D0%B0%D0%BD%D1%81%D0%BB%D0%B8%D1%82%D0%B5%D1%80%D0%B0%D1%86%D0%B8%D0%B8).

## Формальное определение контекста и сочетания букв

Когда составлял правила хотелось:

* чтобы h означала х в контекстах, где её нельзя перепутать с составными буквами, иначе – kh,
* чтобы j после согласных означала ь, а j первая или после гласных - й,
* чтобы ъe/ъя в разрешённых русским языком местах кодировались je/ja,
* чтобы ьe/ья в типичных местах кодировались jye/jya,
* чтобы ыe/ыя в типичных местах кодировались yje/yja,
* для остальных случаев нужно ввести контекстно-независимые й/jh, ы/yhh, ъ/\_h\_, ь/\_j\_.

Использованные в определениях регулярные выражения даны лишь в качестве задания формальных правил кодирования. Для удобства в них предполагается, что все символы из `[А-Яа-я_]`, а перед и после слова есть пробелы. Напоминаю, что `\s` обозначает пробельные символы.

| Контекст, Regex                                               |     Замена     |                                     Примеры                                      |
|:------------------------------------------------------------- |:--------------:|:--------------------------------------------------------------------------------:|
| **Й**                                                         |    **ј/jh**    |                                                                                  |
| 1. `([ъь_\s])й([ъь_\s])`                                        |   `(.)jh(.)`   |                                   йъог/jh_h_og                                   |
| 2. `([^аяеэёоиыую_ъь\s])й`                                     |    `(.)jh`     |                подйес/podjhes, подйод/podjhod, мурьйин/mur_j_jin                 |
| 3. `(ы)й([еоау])`                                             |   `(y)jh(.)`   |                          белыйа/belyjha, белыйе/belyjhe                          |
| •  `й`                                                        |      `j`       | йод/jod, байес/bajes, белый/belyj, йиппи/jippi, байыс/bajys, байяс/bajyas, йй/jj |
|                                                               |                |                                                                                  |
| **Х**                                                         |  **h/kh/hh**   |                                                                                  |
| 1. `([ъь_\s])х([ъь_\s])`                                        |   `(.)kh(.)`   |                             хья/khjya, хьан/kh_j_an                              |
| 2. `([зсхцчжшщьей])х`                                         |    `(.)kh`     |                 сход/skhod, мех/mekh, мэр/mehr, мурьхин/murjkhin                 |
| 3. `(к)х`                                                     |    `(k)hh`     |                                     кхе/khhe                                     |
| •  `х`                                                        |      `h`       |                        хохолок/hoholok, mur_h_hin/муръхин                        |
| •  `(э)х`                                                     |    `(eh)h`     |                                эхо/ehho, эон/ehon                                |
|                                                               |                |                                                                                  |
| **Ъ**                                                         |  **j/\_h\_**   |                                                                                  |
| 1. `([^аяеэёоиыую_йъь\s])ъ[еёюя]`                              |  `(.)j[eoua]`  |                            объект/objekt, изъян/izjan                            |
| •  `ъ`                                                        |     `_h_`      |                Муъминат/Mu_h_minat, Чанъань/Chan_h_anj, онъ/on_h_                |
|                                                               |                |                                                                                  |
| **Ы**                                                         |    **y/yhh**   |                                                                                  |
| 1. `ы([эоауи])`                                               |    `yhh(.)`    |                                  ыа/yhha, ыи/yhhi                                |
| 2. `ы[еёяю]`                                                  |   `yj[eoau]`   |                           белые/belyje, бедныя/bednyja                           |
| •  `ы`                                                        |      `y`       |                            крыска/kryska, ыпся/ypsya, пыхтел/pyhtel              |
|                                                               |                |                                                                                  |
| **Ь**                                                         |  **j/\_j\_**   |                                                                                  |
| 1. <code>([^аяеэёоиыую_йъь\s])ь([^еёиюяйаэоыуъь]\|[_\s])</code> |   `(.)j(.)`    |                  прячься/pryachjsya, мыться/mytjsya, конь/konj                   |
| 2. `([^аяеэёоиыую_йъь\s])ь[еёиюя]`                             | `(.)jy[eoiua]` |                      пьеса/pjyesa, пьян/pjyan, ладьи/ladjyi                      |
| •  `ь`                                                        |     `_j_`      |                                 чаньол/chan_j_ol                                 |

Ещё примеры:

|     |         |                                     |
|:---:|:-------:|:----------------------------------- |
|  е  | e/ye/je | пена/pena, ель/elj                  |
|  ё  |  yo/jo  | ёмко/yomko, мёд/myod                |
|  ж  |   zh    | yozh/ёж                             |
|  и  |  i/yi   | миг/mig                             |
|  ц  |    c    | civilizacija/цивилизация            |
|  ч  |   ch    | chernysh/черныш, schyotnaya/счётная |
|  ш  |   sh    | shlem/шлем                          |
|  щ  |   shh   | shhyotka/щётка                      |
|  э  |   eh    | ehkran/экран                        |
|  ю  |  yu/ju  | Yulya/Юля                           |
|  я  |  ya/ja  | Izya/Изя                            |

## TO DO

Нужно написать кодировщик и декодировщик на питоне, а потом проверить на каком-нибудь словаре, а так же на случайно-сгенерированных словах.

Я не проверял алгоритм декодирования даже мысленно. Но интуитивно чувствую, что он хорошо определён и реализуем. Собственно, алгоритм кодировки строился такой, чтобы не было такого, чтобы разные русские слова (любые) отображались в одну и ту же транслитерацию.
